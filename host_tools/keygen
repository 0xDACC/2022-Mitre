# Keygen script for saffire
# Team: 0xDACC
# Author: Dillon Driskill and Matthew Weikel

import os

def main():

    f = open("/secrets/key", "wb")  # wb mode allows us to A) make the file B) empty it if it exists, and C) write byte values
    key = os.urandom(16)  # Generate 16 random bytes for the 128 bit key

    keybytes = bytearray(key)  # and make that int array into a byte array
    immutekey = bytes(keybytes)  # and now its an immutable array of bytes

    f.write(immutekey) # and now the file has a bunch of stuff in it
    f.close()

    ifile = open("/secrets/iv", "wb")  # new file for the iv
    iv = os.urandom(16)  # 128 bits

    ivbytes = bytearray(iv)
    immuteiv = bytes(ivbytes)

    ifile.write(immuteiv)  # iv made
    ifile.close()

    return 0

if __name__ == "__main__":
    main()
